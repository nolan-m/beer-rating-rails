<%= content_for(:title, "Breweries | Beer Fridge") %>

<h1>Breweries</h1>
<div class="row">
  <div class="col-md-12">
	<table class="table table-condensed table-hover">
	  <thead>
	    <tr>
	      <th>Name</th>
	      <th>Region</th>
	      <th>Total Beers</th>
	      <th>Average Rating</th>
	    </tr>
	  </thead>
	  <tbody>
	    <% @breweries.sort_by{|b| b.name}.each do |brewery| %>
	      <tr>
	        <td><%= link_to brewery.name, brewery_path(brewery.slug) %></td>
	        <td><%= link_to brewery.region.name, region_path(brewery.region.slug) %></td>
	        <td><%= brewery.beers.length %></td>
	        <% sum = 0 %>
	        <% brewery.beers.each { |b| sum += b.total_rating } %>
	        <td><%= sum / brewery.beers.length %></td>
	      </tr>
	      <% end %>
	  </tbody>
	</table>

</div>
</div>